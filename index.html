<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MagicBlock — Truth or False</title>

<style>
body {
  margin:0;
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg,#140a26,#2a1155,#0b0615);
  color:white;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

/* START SCREEN */

#startScreen { text-align:center; }

.startBtn {
  padding:18px 34px;
  font-size:20px;
  border:none;
  border-radius:16px;
  cursor:pointer;
  color:white;
  background: linear-gradient(90deg,#7c3aed,#a855f7);
  animation:pulse 1.4s infinite;
}

@keyframes pulse {
  0% { box-shadow:0 0 0 0 rgba(168,85,247,0.7); }
  70% { box-shadow:0 0 30px 18px rgba(168,85,247,0); }
  100% { box-shadow:0 0 0 0 rgba(168,85,247,0); }
}

/* GAME CARD */

.card {
  display:none;
  background: rgba(20,10,38,0.92);
  border:1px solid #7c3aed;
  padding:30px;
  border-radius:18px;
  width:560px;
  text-align:center;
  box-shadow:0 0 40px rgba(124,58,237,0.35);
}

h1 { color:#c4b5fd; margin-top:0; }

button.answerBtn {
  padding:14px 18px;
  margin:10px;
  border:none;
  border-radius:12px;
  font-size:16px;
  cursor:pointer;
  width:80%;
  transition:0.25s;
  color:white;
}

.btnA { background: linear-gradient(90deg,#7c3aed,#a855f7); }
.btnB { background: linear-gradient(90deg,#4c1d95,#6d28d9); }

button.answerBtn:hover {
  transform:scale(1.05);
  box-shadow:0 0 16px rgba(168,85,247,0.7);
}

img { width:160px; margin-top:15px; }

#resultBox { display:none; }

input {
  padding:12px;
  border-radius:10px;
  border:none;
  width:70%;
  text-align:center;
  font-size:16px;
}

#certificatePreview {
  display:none;
  margin-top:15px;
  border-radius:12px;
  box-shadow:0 0 25px rgba(168,85,247,0.6);
  max-width:100%;
}
</style>
</head>

<body>

<!-- START -->
<div id="startScreen">
  <h1>MagicBlock Quiz</h1>
  <p>Truth or False Edition</p>
  <button class="startBtn" onclick="startGame()">START</button>
</div>

<!-- GAME -->
<div class="card" id="gameCard">
  <h1>MagicBlock Quiz</h1>
  <h3 id="question"></h3>

  <div id="answers">
    <button class="answerBtn btnA" onclick="choose(0)" id="a0"></button>
    <button class="answerBtn btnB" onclick="choose(1)" id="a1"></button>
  </div>

  <div id="feedback"></div>

  <div id="resultBox">
    <h3>Final Score</h3>
    <p id="scoreText"></p>
    <input id="nickname" placeholder="Enter your nickname">
    <br><br>
    <button class="answerBtn btnA" onclick="buildCertificate()">Generate Certificate</button>
    <button class="answerBtn btnB" onclick="downloadCertificate()">Download Certificate</button>
    <br>
    <canvas id="certCanvas" width="900" height="500" style="display:none;"></canvas>
    <img id="certificatePreview">
  </div>
</div>

<!-- AUDIO -->
<audio id="soundTrue" src="sounds/correct.mp3"></audio>
<audio id="soundFalse" src="sounds/wrong.mp3"></audio>
<audio id="bgMusic" src="sounds/bg.mp3" loop></audio>

<script>
// QUESTIONS
const questions = [
{ q:"MagicBlock enables applications to run fully onchain without servers", options:["True","False"], correct:0 },
{ q:"MagicBlock is built on Solana infrastructure", options:["True","False"], correct:0 },
{ q:"Ephemeral Rollups are permanent always-running rollups", options:["True","False"], correct:1 },
{ q:"$BLOCK is a network token, not a company token", options:["True","False"], correct:0 },
{ q:"Node operators can be slashed for incorrect computation", options:["True","False"], correct:0 },
{ q:"There is only one participation option in the presale", options:["True","False"], correct:1 }
];

let index = 0;
let score = 0;

/* START */
function startGame() {
  startScreen.style.display = "none";
  gameCard.style.display = "block";
  bgMusic.volume = 0.10;
  bgMusic.play();
  showQuestion();
}

/* GAME */
function playSound(ok){ ok ? soundTrue.play() : soundFalse.play(); }

function showQuestion(){
  feedback.innerHTML="";
  const q = questions[index];
  question.innerText = q.q;
  a0.innerText = q.options[0];
  a1.innerText = q.options[1];
}

function choose(i){
  const ok = i===questions[index].correct;
  playSound(ok);
  if(ok){ score++; feedback.innerHTML=`<img src="images/true.png"><p>Correct ✅</p>`; }
  else{ feedback.innerHTML=`<img src="images/false.png"><p>Wrong ❌</p>`; }

  setTimeout(()=>{
    index++;
    if(index<questions.length) showQuestion();
    else finishGame();
  },1400);
}

function finishGame(){
  answers.style.display="none";
  question.style.display="none";
  feedback.innerHTML="";
  resultBox.style.display="block";
  scoreText.innerText=`You got ${score} out of ${questions.length}`;
}

/* CERTIFICATE WITH RANK BADGE */
function getRank(score,total){
  if(score===total) return {name:"PERFECT NODE", color:"#facc15"};
  if(score>=4) return {name:"ROLLUP PRO", color:"#a855f7"};
  if(score>=2) return {name:"BLOCK EXPLORER", color:"#60a5fa"};
  return {name:"ONCHAIN ROOKIE", color:"#9ca3af"};
}

function drawBadge(ctx,x,y,r,text,color){
  ctx.beginPath();
  ctx.arc(x,y,r,0,Math.PI*2);
  ctx.fillStyle=color; ctx.globalAlpha=0.25; ctx.fill(); ctx.globalAlpha=1;

  ctx.beginPath();
  ctx.arc(x,y,r-10,0,Mat
